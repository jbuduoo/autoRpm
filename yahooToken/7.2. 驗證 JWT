7.2. 驗證 JWT
驗證 JWT 時，將執行以下步驟。在步驟的輸入和輸出之間沒有依賴關係的情況下，步驟的順序並不重要。如果列出的任何步驟失敗，則 JWT 必須被拒絕——也就是說，應用程序將其視為無效輸入。

驗證 JWT 是否包含至少一個句點 ('.') 字符。
讓 Encoded JOSE Header 成為 JWT 在第一個句點 ('.') 字符之前的部分。
Base64url 在沒有使用換行符、空格或其他附加字符的限制之後對 Encoded JOSE Header 進行解碼。
驗證生成的八位字節序列是符合RFC 7159 [RFC7159]的完全有效 JSON 對象的 UTF-8 編碼表示；讓 JOSE Header 成為這個 JSON 對象。
驗證生成的 JOSE 標頭是否僅包含語法和語義都被理解和支持的參數和值，或者在不理解時被指定為被忽略的參數和值。
使用[JWE]的第 9 節中描述的任何方法確定 JWT 是 JWS 還是JWE 。
根據 JWT 是 JWS 還是 JWE，有兩種情況：
如果 JWT 是 JWS，請按照[JWS]中指定的步驟驗證 JWS。讓 Message 成為 base64url 解碼 JWS Payload 的結果。
否則，如果 JWT 是 JWE，請按照[JWE]中指定的步驟驗證 JWE。讓 Message 成為結果明文。
如果 JOSE 標頭包含一個城市（內容類型）的值智威湯遜，則消息是一個 JWT，它是嵌套簽名或加密操作的主題。在這種情況下，返回第 1 步，使用消息作為 JWT。
否則，base64url 在沒有使用換行符、空格或其他附加字符的限制之後對消息進行解碼。
驗證生成的八位字節序列是符合RFC 7159 [RFC7159]的完全有效 JSON 對象的 UTF-8 編碼表示；讓 JWT 聲明集成為這個 JSON 對象。
最後，請注意，在給定的上下文中可以使用哪些算法是一個應用程序決定。即使可以成功驗證 JWT，除非應用程序可以接受 JWT 中使用的算法，否則它應該拒絕 JWT。
